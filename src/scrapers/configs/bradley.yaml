name: "bradley"
base_url: "https://www.bradleycaldwell.com"
test_skus: ["791611038437"]
timeout: 30
retries: 3

selectors:
  - name: "Name"
    selector: "h1.product-name"
    attribute: "text"
  - name: "Brand"
    selector: "div.product-brand > a, a[href*='/brand/']"
    attribute: "text"
  - name: "Weight"
    selector: "//table[contains(@class, 'table')]//tr[td/strong[text()='Weight']]/td[2]"
    attribute: "innerHTML"
  - name: "Image URLs"
    selector: "#main-slider-desktop a[href*='/ccstore/v1/images'], #main-slider-mobile a[href*='/ccstore/v1/images']"
    attribute: "href"
    multiple: true

workflows:
  - action: "navigate"
    params:
      # This URL from the legacy python script assumes the {sku} variable will be surrounded by asterisks.
      url: "https://www.bradleycaldwell.com/search?term={sku}"

  - action: "wait_for"
    params:
      # Wait for either the product name (success) or the "no results" message (failure)
      selector: ["h1.product-name", "//h2[contains(text(), 'No products were found.')]"]
      timeout: 20

  - action: "check_no_results"

  - action: "conditional_skip"
    params:
      if_flag: "no_results_found"

  # If we are here, it means the product page loaded directly.
  - action: "extract"
    params:
      fields: ["Name", "Brand", "Weight", "Image URLs"]

validation:
  no_results_selectors:
    - "//h2[contains(text(), 'No products were found.')]"
  no_results_text_patterns:
    - "No products were found."
