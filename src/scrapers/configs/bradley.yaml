name: "bradley"
base_url: "https://www.bradleycaldwell.com"
test_skus: ["791611038437"]
timeout: 30
retries: 3

selectors:
  - name: "Name"
    selector: "h1"
    attribute: "text"
  - name: "Brand"
    selector: "//p[contains(text(), 'By:')]/a"
    attribute: "text"
  - name: "Weight"
    selector: "//li[contains(text(), 'Weight:')]"
    attribute: "text"
  - name: "Image URLs"
    selector: "img[src*='/products/']"
    attribute: "src"
    multiple: true

workflows:
  - action: "navigate"
    params:
      # This URL from the legacy python script assumes the {sku} variable will be surrounded by asterisks.
      url: "https://www.bradleycaldwell.com/search?term={sku}"

  - action: "wait_for"
    params:
      # Wait for either the product results (success) or the "no results" message (failure)
      selector: ["article", "//h3[contains(text(), 'Sorry, no results')]"]
      timeout: 20

  - action: "check_no_results"
    params:
      min_confidence: 0.5

  - action: "conditional_skip"
    params:
      if_flag: "no_results_found"

  # If we are here, results were found. Click on the first product link.
  - action: "click"
    params:
      selector: "article a[href]"

  - action: "wait_for"
    params:
      selector: "//p[contains(text(), 'By:')]"
      timeout: 20

  # Extract product details
  - action: "extract"
    params:
      fields: ["Name", "Brand", "Weight", "Image URLs"]

validation:
  no_results_selectors:
    - "//h3[contains(text(), 'Sorry, no results')]"
  no_results_text_patterns:
    - "Sorry, no results for"
